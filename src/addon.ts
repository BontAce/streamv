import { addonBuilder, Manifest, Stream } from "stremio-addon-sdk";
import { getStreamContent, VixCloudStreamInfo } from "./extractor";

const manifest: Manifest = {
    id: "org.stremio.vixsrc",
    version: "0.1.0",
    name: "StreamViX",
    description: "Addon for Vixsrc streams.", 
    icon: "data:image/png;base64,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",
    background: "/public/backround.png", // Aggiungi /public/ qui
    types: ["movie", "series"],
    idPrefixes: ["tt"],
    catalogs: [],
    // Usa la forma abbreviata per le risorse
    resources: ["stream"] 
};

const builder = new addonBuilder(manifest);


builder.defineStreamHandler(
  async ({
    id,
    type,
  }): Promise<{
    streams: Stream[];
  }> => {
    try {
      const res: VixCloudStreamInfo[] | null = await getStreamContent(id, type);

      if (!res) {
        return { streams: [] };
      }

      let streams: Stream[] = [];
      for (const st of res) {
        if (st.streamUrl == null) continue;
        streams.push({
          title: st.name,
          url: st.streamUrl,
          // behaviorHints: { notWebReady: true } // Retain if m3u8 might not be web-ready
          behaviorHints: {
            notWebReady: true,
          },
          proxyHeaders: { "request": { "Referer": st.referer } }
        } as Stream); // Explicitly cast to Stream
      }
      return { streams: streams };
    } catch (error) {
      console.error('Stream extraction failed:', error);
      return { streams: [] };
    }
  }
);

export const addon = builder;
export default builder.getInterface();
